{% extends 'main/base.html' %}
{% block title %}Registro - INACAP Tutorías{% endblock %}

{% block content %}
<div class="header">
    <h1><i class="fa-solid fa-user-plus"></i> Crear Cuenta</h1>
    <p>Únete a la plataforma de tutorías de INACAP</p>
</div>

<form method="post" novalidate>
    {% csrf_token %}
    
    {% if form.non_field_errors %}
    <div class="mensaje-error">
        {% for error in form.non_field_errors %}
        <p>{{ error }}</p>
        {% endfor %}
    </div>
    {% endif %}

    <div class="form-group">
        <label for="{{ form.username.id_for_label }}">{{ form.username.label }}</label>
        {{ form.username }}
        {% if form.username.errors %}
        <ul class="errorlist">
            {% for error in form.username.errors %}
            <li>{{ error }}</li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>

    <div class="form-group">
        <label for="{{ form.first_name.id_for_label }}">{{ form.first_name.label }}</label>
        {{ form.first_name }}
        {% if form.first_name.errors %}
        <ul class="errorlist">
            {% for error in form.first_name.errors %}
            <li>{{ error }}</li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>

    <div class="form-group">
        <label for="{{ form.last_name.id_for_label }}">{{ form.last_name.label }}</label>
        {{ form.last_name }}
        {% if form.last_name.errors %}
        <ul class="errorlist">
            {% for error in form.last_name.errors %}
            <li>{{ error }}</li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>

    <div class="form-group">
        <label for="{{ form.email.id_for_label }}">{{ form.email.label }}</label>
        {{ form.email }}
        {% if form.email.errors %}
        <ul class="errorlist">
            {% for error in form.email.errors %}
            <li>{{ error }}</li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>

    <div class="form-group">
        <label for="{{ form.genero.id_for_label }}">{{ form.genero.label }}</label>
        {{ form.genero }}
        {% if form.genero.errors %}
        <ul class="errorlist">
            {% for error in form.genero.errors %}
            <li>{{ error }}</li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>

    <div class="form-group">
        <label for="{{ form.rut.id_for_label }}">{{ form.rut.label }}</label>
        {{ form.rut }}
        {% if form.rut.errors %}
        <ul class="errorlist">
            {% for error in form.rut.errors %}
            <li>{{ error }}</li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>

    <div class="form-group">
        <label for="{{ form.sede.id_for_label }}">{{ form.sede.label }}</label>
        {{ form.sede }}
        {% if form.sede.errors %}
        <ul class="errorlist">
            {% for error in form.sede.errors %}
            <li>{{ error }}</li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>

    <div class="form-group">
        <label for="{{ form.carrera.id_for_label }}">{{ form.carrera.label }}</label>
        {{ form.carrera }}
        {% if form.carrera.errors %}
        <ul class="errorlist">
            {% for error in form.carrera.errors %}
            <li>{{ error }}</li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>

    <div id="semestre_container" class="form-group">
        <label for="{{ form.semestre_actual.id_for_label }}">{{ form.semestre_actual.label }}</label>
        {{ form.semestre_actual }}
        {% if form.semestre_actual.errors %}
        <ul class="errorlist">
            {% for error in form.semestre_actual.errors %}
            <li>{{ error }}</li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>

    <div id="promedio_container" class="form-group">
        <label for="{{ form.promedio_general.id_for_label }}">{{ form.promedio_general.label }}</label>
        {{ form.promedio_general }}
        {% if form.promedio_general.errors %}
        <ul class="errorlist">
            {% for error in form.promedio_general.errors %}
            <li>{{ error }}</li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>

    <div class="form-group">
        <label style="display: flex; align-items: center; gap: 10px;">
            {{ form.es_tutor }}
            <span>{{ form.es_tutor.label }}</span>
        </label>
        {% if form.es_tutor.errors %}
        <ul class="errorlist">
            {% for error in form.es_tutor.errors %}
            <li>{{ error }}</li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>

    <div id="detalle_tutor" style="display:none; margin-top: 1em;">
        <div class="form-group">
            <label for="{{ form.especialidades.id_for_label }}">{{ form.especialidades.label }}</label>
            {{ form.especialidades }}
            {% if form.especialidades.errors %}
            <ul class="errorlist">
                {% for error in form.especialidades.errors %}
                <li>{{ error }}</li>
                {% endfor %}
            </ul>
            {% endif %}
        </div>

        <div class="form-group">
            <label for="{{ form.años_experiencia.id_for_label }}">{{ form.años_experiencia.label }}</label>
            {{ form.años_experiencia }}
            {% if form.años_experiencia.errors %}
            <ul class="errorlist">
                {% for error in form.años_experiencia.errors %}
                <li>{{ error }}</li>
                {% endfor %}
            </ul>
            {% endif %}
        </div>
    </div>

    <div class="form-group">
        <label for="{{ form.password1.id_for_label }}">{{ form.password1.label }}</label>
        {{ form.password1 }}
        {% if form.password1.errors %}
        <ul class="errorlist">
            {% for error in form.password1.errors %}
            <li>{{ error }}</li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>

    <div class="form-group">
        <label for="{{ form.password2.id_for_label }}">{{ form.password2.label }}</label>
        {{ form.password2 }}
        {% if form.password2.errors %}
        <ul class="errorlist">
            {% for error in form.password2.errors %}
            <li>{{ error }}</li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>

    <div class="sesion-actions">
        <button type="submit" class="btn btn-primary">
            <i class="fa-solid fa-user-plus"></i> Registrar
        </button>
        <a href="{% url 'login' %}" class="btn btn-secondary">
            <i class="fa-solid fa-sign-in-alt"></i> Ya tengo cuenta
        </a>
    </div>
</form>

<script>
const tutorCheckbox = document.getElementById('id_es_tutor');
const detalleTutor = document.getElementById('detalle_tutor');
const promedioContainer = document.getElementById('promedio_container');
const semestreContainer = document.getElementById('semestre_container');

function toggleDetallesTutor() {
    if (tutorCheckbox.checked) {
        detalleTutor.style.display = 'block';
        promedioContainer.style.display = 'none';
        semestreContainer.style.display = 'none';
    } else {
        detalleTutor.style.display = 'none';
        promedioContainer.style.display = '';
        semestreContainer.style.display = '';
    }
}

if (tutorCheckbox) {
    tutorCheckbox.addEventListener('change', toggleDetallesTutor);
    window.onload = toggleDetallesTutor;
}
</script>
{% endblock %}
